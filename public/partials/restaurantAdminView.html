<div class="header">
    <div class="container">
        <div class="header-wrap">
            <p class="icon-wrap">
                <button ng-click="menuState='active'" class="icon icon-12"></button>
            </p>
            <p id="logo">Luncher</p>
        </div>
    </div>
</div>
<div ng-class="menuState" class="menu">
    <h2>{{restaurant.name}}</h2>
    <p class="icon-wrap">
        <button ng-click="menuState=''" class="icon icon-9"></button>
    </p>
    <ul>
        <li><a href="javascript:undefined"><span class="icon-1"></span>Restorani andmed</a></li>
        <li><a href="javascript:undefined"><span class="icon-17"></span>Facebooki seaded</a></li>
        <li><a href="javascript:undefined"><span class="icon-5"></span>Asukoha seaded</a></li>
        <li><a href="javascript:undefined"><span class="icon-3"></span>Tagasiside</a></li>
    </ul>
</div>
<div class="overlay"></div>
<div class="content">
    <div class="container">
        <div class="offer-form-wrap">
            <form class="offer-form" novalidate ng-submit="postOffer()" ng-controller="RestaurantAddOfferCtrl" name="form" ng-class="newOfferFormState">
                <div class="row">
                    <div class="col-md-4 col-sm-3">
                        <p>
                            <input ng-model="title" name="title" id="new-offer-title" type="text" ng-minlength="5" ng-maxlength="20" required>
                            <label ng-class="{filled: form.title.$viewValue}" for="new-offer-title">
                              <span ng-show="!isReadyForError(form.title)">
                                Nimetus
                              </span>
                              <span ng-show="isReadyForError(form.title)" class="errors">
                                <span ng-show="form.title.$error.required">
                                  Nimetus on kohustuslik.
                                </span>
                                <span ng-show="form.title.$error.minlength">
                                  Nimetus peab olema vähemalt 5 tähte.
                                </span>
                                <span ng-show="form.title.$error.maxlength">
                                  Nimetus võib olla kuni 20 tähte. ({{20-form.title.$viewValue.length}})
                                </span>
                              </span>
                            </label>
                        </p>
                        <p>
                            <!-- The dirty check isn't working in this version of angular (https://github.com/mbenford/ngTagsInput/issues/341)
                                 because of this we have to mark it manually for now-->
                            <tags-input ng-model="tags" name="tags" id="new-offer-tags" min-tags="3"
                             on-tag-added="form.tags.$dirty=true" on-tag-removed="form.tags.$dirty=true" ng-class="{'ng-dirty': form.tags.$dirty}">
                            <label ng-class="{filled: tags.length || form.tags.$error.leftoverText}" for="new-offer-tags">
                              <span ng-show="!isReadyForError(form.tags)">
                                Koostisosad
                              </span>
                              <span ng-show="isReadyForError(form.tags)" class="errors" >
                                <span ng-show="!tags.length">
                                  Koostisosad on kohustuslikud.
                                </span>
                                <span ng-show="form.tags.$error.minTags && tags.length">
                                  Pakkumine peab sisaldama vähemalt 3 koostisosa.
                                </span>
                              </span>
                            </label>
                        </p>
                        <p>
                            <input ng-model="price" name="price" id="new-offer-price" type="number" min="0" required>
                            <label ng-class="{filled: !form.price.$error.required}" for="new-offer-price">
                              <span ng-show="!isReadyForError(form.price)">
                                Hind
                              </span>
                              <span ng-show="isReadyForError(form.price)" class="errors">
                                <span ng-show="form.price.$error.required">
                                  Hind on kohustuslik.
                                </span>
                                <span ng-show="form.price.$error.min">
                                  Hind ei tohi olla negatiivne.
                                </span>
                                <span ng-show="form.price.$error.number">
                                  Hind peab olema korrektne number.
                                </span>
                              </span>
                            </label>
                        </p>
                        <div class="row">
                            <div class="col-xs-3">
                                <p>
                                    <input ng-model="date" name="date" id="new-offer-date" type="date" min="{{today}}" required>
                                    <label ng-class="{filled: !form.date}" for="new-offer-date">
                                      <span ng-show="!isReadyForError(form.date)">
                                        Kuupäev
                                      </span>
                                      <span ng-show="isReadyForError(form.date)" class="errors">
                                        <span ng-show="form.date.$error.required">
                                          Kuupäev on kohustuslik.
                                        </span>
                                        <span ng-show="form.date.$error.date">
                                          Kuupäev on vigane.
                                        </span>
                                        <span ng-show="form.date.$error.min">
                                          Kuupäev ei tohi olla minevikus.
                                        </span>
                                      </span>
                                    </label>
                                </p>
                            </div>
                            <div class="col-xs-3">
                                <div class="row">
                                    <div class="col-xs-3">
                                        <p class="input-sep">
                                            <input ng-model="fromTime" name="fromTime" id="new-offer-fromTime" value="11:30" type="time" required>
                                            <label ng-class="{filled: fromTime}" for="new-offer-fromTime">
                                              <span ng-show="!isReadyForError(form.fromTime, form.toTime)">
                                                Kellaaeg
                                              </span>
                                              <span ng-show="isReadyForError(form.fromTime, form.toTime)" class="errors">
                                                <span ng-show="form.fromTime.$error.required || form.toTime.$error.required">
                                                  Kellaajad on kohustuslikud.
                                                </span>
                                                <span ng-show="form.fromTime.$error.time || form.toTime.$error.time">
                                                  Kellaajad on vigased.
                                                </span>
                                                <span ng-show="form.toTime.$error.min">
                                                  Algusaeg peab olema enne lõpuaega.
                                                </span>
                                              </span>
                                            </label>
                                        </p>
                                    </div>
                                    <div class="col-xs-3">
                                        <p>
                                            <input ng-model="toTime" name="toTime" id="new-offer-toTime" value="15:00" type="time"
                                            min="{{form.fromTime.$valid ? form.fromTime.$viewValue : '00:00'}}" required>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-2 col-sm-3">
                        <p>
                            <input ng-model="image" name="image" id="new-offer-image" type="file" accept="image/*" value="" preview-image>
                            <label ng-class="{filled: previewImageSrc}" for="new-offer-image">Pilt</label>
                        </p>
                        <p class="image-preview">
                            <label for="new-offer-image">
                              <img ng-show="previewImageSrc" ng-src="{{previewImageSrc}}" alt="">
                            </label>
                        </p>
                    </div>
                </div>
                <p class="buttons">
                    <a class="btn btn-secondary" href="javascript:undefined" ng-click="newOfferFormState=''">
                        Loobu
                    </a>
                    <input class="btn" type="submit" ng-disabled="form.$invalid" value="Salvesta">
                </p>
            </form>
            <p class="new-offer-btn">
                <a href="javascript:undefined" ng-click="newOfferFormState='active'"><span class="icon-4"></span>Lisa uus pakkumine</a>
            </p>
        </div>
        <div class="offers-wrap" ng-controller="RestaurantOfferListCtrl">
            <div class="offer" ng-repeat="offer in offers" id="{{offer._id}}" ng-class="{pending: offer.confirmationPending}">
                <p class="icon-wrap"><a href="javascript:undefined" class="icon icon-15"></a></p>
                <div class="offer-content">
                    <div class="col-1">
                        <p>{{offer.title}}</p>
                    </div>
                    <div class="col-2">
                        <div class="col-wrap">
                            <p class="mobile">{{offer.title}}</p>
                            <p class="additional desktop">{{offer.description}}</p>
                            <p class="price">{{offer.price}} €</p>
                        </div>
                        <p class="additional mobile">{{offer.description}}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
